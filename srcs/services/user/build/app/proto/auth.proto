syntax = "proto3";

package auth.user;

import "google/protobuf/empty.proto";


service AuthUserService
{
  rpc CheckDomain(CheckDomainRequest)             returns (google.protobuf.Empty) {}
  rpc HashPassword(HashPasswordRequest)           returns (HashedPassword) {}
  rpc GenerateTFASecret(google.protobuf.Empty)    returns (TFASecret) {}
  rpc CheckTFACode(CheckTFACodeRequest)           returns (google.protobuf.Empty) {}
  rpc GenerateJWT(GenerateJWTRequest)             returns (JWT) {}
}

message CheckDomainRequest
{
  string domain = 1;
}

message HashPasswordRequest
{
  string password = 1;
}
message HashedPassword
{
  string hashed_password = 1;
}

message TFASecret
{
  string tfa_secret = 1;
}

message CheckTFACodeRequest
{
  string tfa_secret  = 1;
  string tfa_code    = 2;
}

message GenerateJWTRequest //TODO short lived 5m jwt for pending tfa, long lived jwt for normal login
{
  string user_id     = 1;
  uint16 auth_level  = 2;
  bool   pending_tfa = 3;
}
message JWT
{
  string jwt = 1;
}
# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    openapi.yaml                                       :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: craimond <bomboclat@bidol.juis>            +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2024/10/05 19:23:58 by craimond          #+#    #+#              #
#    Updated: 2024/11/28 15:29:35 by craimond         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

openapi: 3.1.0
info:
  title: Pongfumasters API
  description: REST-ful API to interact with the Pongfumasters gateway.
  version: 1.0.0
servers:
  - url: pongfumasters.com/api/v1
    description: Main API server
security:
  - jwtAuth: []
paths:
  /ping:
    get:
      operationId: ping
      summary: Ping the API
      description: Returns a simple pong response to check if the API is alive.
      x-auth-level: 0
      responses:
        "200":
          description: API is responsive.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            text/plain:
              schema:
                type: string
                example: "pong...FUMASTERS!"

  /users:
    post:
      operationId: registerUser
      summary: User registration
      description: Register a new user in the system by providing email, password, display name, and other  fields.
      x-auth-level: 0
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  $ref: "#/components/schemas/user_email"
                password:
                  $ref: "#/components/schemas/user_psw"
                display_name:
                  $ref: "#/components/schemas/user_display_name"
                avatar:
                  $ref: "#/components/schemas/user_avatar"
              required: [email, password, display_name]
              additionalProperties: false
        required: true
      responses:
        "201":
          description: User registration successful.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_id:
                    $ref: "#/components/schemas/user_id"
                required: [user_id]
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
  /users/{user_id}/profile:
    get:
      operationId: getUserPublicProfile 
      summary: Get user profile
      description: Retrieve the public profile of a user account by providing the user ID.
      parameters:
        - $ref: "#/components/parameters/user_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "200":
          description: Returns the Public User object of the specified user.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserPublicProfile"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /users/{user_id}/status:
    get:
      operationId: getUserStatus
      summary: Get user status
      description: Retrieve the status of a specific user.
      parameters:
        - $ref: "#/components/parameters/user_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "200":
          description: Returns the status of the user.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    $ref: "#/components/schemas/user_status"
                required: [status]
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /users/{user_id}/matches:
    get:
      operationId: getUserMatches
      summary: Get list of user matches.
      description: Returns the list of matches a user has ever played in.
      parameters:
        - $ref: "#/components/parameters/user_id"
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
      x-auth-level: 2
      security:
        - jwtAuth: []
      responses:
        "200":
          description: Matches list successfully retrieved.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Match"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /users/{user_id}/tournaments:
    get:
      operationId: getUserTournaments
      summary: Get list of user tournaments.
      description: Returns the list of tournaments a user has ever participated in.
      parameters:
        - $ref: "#/components/parameters/user_id"
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
      x-auth-level: 2
      security:
        - jwtAuth: []
      responses:
        "200":
          description: Tournaments list successfully retrieved.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Tournament"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"

  /user:
    delete:
      operationId: deleteAccount
      summary: Delete a user account
      description: Permanently delete the account of the current user.
      x-auth-level: 2
      security:
        - jwtAuth: []
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /user/profile:
    get:
      operationId: getUserPrivateProfile
      summary: Get current user"s profile
      description: Retrieve detailed information about the current user.
      x-auth-level: 2
      security:
        - jwtAuth: []
      responses:
        "200":
          description: Returns the Private User object of the specified user.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserPrivateProfile"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
    patch:
      operationId: updateProfile
      summary: Update user profile
      description: Update the public profile of the current user.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                display_name:
                  $ref: "#/components/schemas/user_display_name"
                avatar:
                  $ref: "#/components/schemas/user_avatar"
              required: []
              additionalProperties: false
        required: true
      x-auth-level: 2
      security:
        - jwtAuth: []
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /user/tfa:
    post:
      operationId: enableTFA
      summary: Setup tfa
      description: Enable two-factor authentication for the current user account.
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "200":
          description: Two-factor authentication successfully enabled.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  tfa_secret:
                    $ref: "#/components/schemas/tfa_secret"
                  tfa_provisioning_uri:
                    $ref: "#/components/schemas/tfa_provisioning_uri"
                required: [tfa_secret, tfa_provisioning_uri]
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
    get:
      operationId: getTFAStatus
      summary: Get tfa status
      description: Retrieve the two-factor authentication status of a user account.
      parameters:
        - $ref: "#/components/parameters/user_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "200":
          description: Returns the tfa status of the current user.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  tfa_status:
                    $ref: "#/components/schemas/tfa_status"
                required: [tfa_status]
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
    delete:
      operationId: disableTFA
      summary: Disable tfa
      description: Disable two-factor authentication for a user account.
      parameters:
        - $ref: "#/components/parameters/tfa_code"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /user/tfa/verify:
    post:
      operationId: submitTFACode
      summary: Submit tfa code
      description: Submit the two-factor authentication code for verification.
      parameters:
        - $ref: "#/components/parameters/tfa_code"
      security:
        - jwtAuth: []
      x-auth-level: 1
      responses:
        "200":
          description: Two-factor authentication code successfully verified.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  jwt:
                    $ref: "#/components/schemas/jwt"
                required: [jwt]
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /user/login:
    post:
      operationId: loginUser
      summary: User login
      description: Authenticate the user and return a JWT for session management.
      x-auth-level: 0
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  $ref: "#/components/schemas/user_email"
                password:
                  $ref: "#/components/schemas/user_psw"
              required: [email, password]
              additionalProperties: false
        required: true
      responses:
        "200":
          description: User successfully logged in.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  jwt:
                    $ref: "#/components/schemas/jwt"
                required: [jwt]
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /user/friends:
    post:
      operationId: addFriend
      summary: Add a friend
      description: Add a user to the friend list.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                friend_id:
                  $ref: "#/components/schemas/user_id"
              required: [friend_id]
              additionalProperties: false
        required: true
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
    get:
      operationId: getFriends
      summary: Get list of friends
      description: Retrieve the list of friends of the current user.
      parameters:
        - $ref: "#/components/parameters/limit"
        - $ref: "#/components/parameters/offset"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "200":
          description: Friends list successfully retrieved.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/user_id"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /user/friends/{friend_id}:
    delete:
      operationId: removeFriend
      summary: Remove a friend
      description: Remove a user from the friend list.
      parameters:
        - $ref: "#/components/parameters/friend_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"

  /matches:
    post:
      operationId: createMatch
      summary: Start a new match
      description: Initialize a new Pong match by providing the match settings and the opponent user IDs.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                invited_user_id:
                  $ref: "#/components/schemas/user_id"
              required: [invited_user_id]
              additionalProperties: false
        required: true
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "201":
          description: Returns the match ID of the newly created match.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                type: object
                properties:
                  match_id:
                    $ref: "#/components/schemas/match_id"
                required: [match_id]
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /matches/{match_id}:
    get:
      operationId: getMatch
      summary: Get match info
      description: Retrieve details about a specific match using its ID.
      parameters:
        - $ref: "#/components/parameters/match_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "200":
          description: Returns match information.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Match"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
    delete:
      operationId: leaveMatch
      summary: Leave the current match
      description: Exit and terminate the ongoing match.
      parameters:
        - $ref: "#/components/parameters/match_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /matches/{match_id}/accept:
    post:
      operationId: acceptMatchInvitation
      summary: Accept match invitation
      description: Accept an invitation to join a match by providing the match ID.
      parameters:
        - $ref: "#/components/parameters/match_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /matches/{match_id}/decline:
    post:
      operationId: declineMatchInvitation
      summary: Decline match invitation
      description: Decline an invitation to join a match by providing the match ID.
      parameters:
        - $ref: "#/components/parameters/match_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"

  /tournaments:
    post:
      operationId: createTournament
      summary: Start a new tournament
      description: Initialize a new Pong tournament by providing a list of users to invite and tournament mode.
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "201":
          description: Returns the tournament ID of the newly created tournament.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/tournament_id"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /tournaments/{tournament_id}:
    get:
      operationId: getTournament
      summary: Get tournament info
      description: Retrieve details about a specific tournament using its ID.
      parameters:
        - $ref: "#/components/parameters/tournament_id"
      x-auth-level: 2
      responses:
        "200":
          description: Returns match information.
          headers:
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            Content-Type:
              $ref: "#/components/headers/Content-Type"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Tournament"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
    delete:
      operationId: cancelTournament
      summary: Cancel a tournament
      description: Cancel an ongoing tournament and remove all participants.
      parameters:
        - $ref: "#/components/parameters/tournament_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
  /tournaments/{tournament_id}/partecipants:
    post:
      operationId: joinTournament
      summary: Join a tournament
      description: Register the current user to participate in a tournament.
      parameters:
        - $ref: "#/components/parameters/tournament_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "411":
          $ref: "#/components/responses/LengthRequired"
        "413":
          $ref: "#/components/responses/ContentTooLarge"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"
    delete:
      operationId: leaveTournament
      summary: Leave a tournament
      description: Unregister the current user from a tournament.
      parameters:
        - $ref: "#/components/parameters/tournament_id"
      security:
        - jwtAuth: []
      x-auth-level: 2
      responses:
        "204":
          $ref: "#/components/responses/NoContent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"
        "431":
          $ref: "#/components/responses/RequestHeaderFieldsTooLarge"

components:
  schemas:

    user_id:
      description: Unique identifier for the user (or AI bot) (UUID format or similar).
      type: string
      format: uuid
      example: 550e8400-e29b-41d4-a716-446655440000
    user_psw:
      description: User"s password (plain-text) for authentication.
      type: string
      example: "StrongPassword123!"
    user_email:
      description: User"s email address, used for login and notifications.
      type: string
      format: email
      example: "example@example.com"
    user_display_name:
      description: Display name of the user, visible to other players during gameplay.
      type: string
      example: "PongMaster123"
    user_avatar:
      description: User"s avatar image in base64 encoding, used for profile picture, defaults to a generic avatar if not provided.
      type: string
      example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABjklEQVRIS+2Vv0oDQRDG..."
    user_status:
      description: Current status of the user (online or offline).
      type: string
      enum: [online, offline]
      example: "online"

    match_id:
      description: Unique identifier for the match (UUID format or similar).
      type: string
      format: uuid
      example: 550e8400-e29b-41d4-a716-446655440000
    match_status:
      description: Current status of the match.
      type: string
      enum: [ongoing, completed]
      example: "ongoing"

    player_position:
      description: Position of the player in the leaderboard.
      type: integer
      format: int32
      minimum: 1
      example: 3

    tournament_id:
      description: Unique identifier for the tournament (UUID format or similar).
      type: string
      format: uuid
      example: 550e8400-e29b-41d4-a716-446655440000
    tournament_status:
      description: Current status of the tournament.
      type: string
      enum: [ongoing, completed]
      example: "ongoing"
    timestamp:
      description: Timestamp in unix timestamp format.
      type: integer
      format: int64
      example: 1634265600

    tfa_status:
      description: Status of the TFA authentication for the user.
      type: boolean
      example: true

    qr_code:
      description: QR code image in base64 encoding.
      type: string
      format: base64
      example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABjklEQVRIS+2Vv0oDQRDG..."
  
    tfa_code:
      description: 2FA code generated by the user for TFA authentication.
      type: string #string because it can contain leading zeros
      example: "123456"

    tfa_secret:
      description: 2FA secret key for generating TFA codes.
      type: string
      example: "otpauth://tfa/{issuer}:{account}?secret={secret}&issuer={issuer}"
    
    tfa_provisioning_uri:
      description: URI for provisioning TFA on a device.
      type: string
      example: "otpauth://tfa/{issuer}:{account}?secret={secret}&issuer={issuer}"

    jwt:
      description: JWT for session management.
      type: string
      example: "<Header>.<Payload>.<Signature>"


    UserPublicProfile:
      description: Represents a public user profile with limited information.
      type: object
      properties: 
        id:
          $ref: "#/components/schemas/user_id"
        display_name:
          $ref: "#/components/schemas/user_display_name"
        avatar:
          $ref: "#/components/schemas/user_avatar"
        status:
          $ref: "#/components/schemas/user_status"
      required: [id, display_name, avatar, status]

    UserPrivateProfile:
      description: Represents a private user profile with additional information.
      type: object
      allOf:
        - $ref: "#/components/schemas/UserPublicProfile"
        - properties:
            email:
              $ref: "#/components/schemas/user_email"
            tfa_status:
              $ref: "#/components/schemas/tfa_status"
          additionalProperties: false
      required: [id, display_name, avatar, status, email, tfa_status]

    Match:
      description: Represents a match of Pong between two players.
      type: object
      properties:
        id:
          $ref: "#/components/schemas/match_id"
        creator_id:
          $ref: "#/components/schemas/user_id"
        player_ids:
          type: array
          items:
            $ref: "#/components/schemas/user_id"
        status:
          $ref: "#/components/schemas/match_status"
        started_timestamp:
          $ref: "#/components/schemas/timestamp"
        finished_timestamp:
          $ref: "#/components/schemas/timestamp"
      required: [id, creator_id, player_ids, status, started_timestamp]

    Tournament:
      description: Represents a Pong tournament, containing multiple matches and players.
      type: object
      properties:
        id:
          $ref: "#/components/schemas/tournament_id"
        creator_id:
          $ref: "#/components/schemas/user_id"
        match_ids:
          type: array
          items:
            $ref: "#/components/schemas/match_id"
        status:
          $ref: "#/components/schemas/tournament_status"
        started_timestamp:
          $ref: "#/components/schemas/timestamp"
        finished_timestamp:
          $ref: "#/components/schemas/timestamp"
      required: [id, creator_id, match_ids, status, started_timestamp]

  parameters:

    user_id:
      description: Unique identifier of the user.
      name: user_id
      in: path
      schema:
        $ref: "#/components/schemas/user_id"
      required: true
    match_id:
      description: Unique identifier of the match.
      name: match_id
      in: path
      schema:
        $ref: "#/components/schemas/match_id"
      required: true
    tournament_id:
      description: Unique identifier of the tournament.
      name: tournament_id
      in: path
      schema:
        $ref: "#/components/schemas/tournament_id"
      required: true
    friend_id:
      description: Unique identifier of the friend.
      name: friend_id
      in: path
      schema:
        $ref: "#/components/schemas/user_id"
      required: true

    token:
      description: verification token for credentials recovery/validation
      name: token
      in: header
      schema:
        type: string
      required: true
    
    tfa_code:
      description: 2FA code generated by the user for TFA authentication.
      name: tfa_code
      in: header
      schema:
        $ref: "#/components/schemas/tfa_code"
      required: true

    limit:
      description: Maximum number of items to return.
      name: limit
      in: query
      schema:
        type: integer
        format: int32
        minimum: 1
      required: false

    offset:
      description: Number of items to skip.
      name: offset
      in: query
      schema:
        type: integer
        format: int32
        minimum: 0
      required: false

  headers:

    Content-Type:
      description: The MIME type of the response body.
      schema:
        type: string
      example: application/json

    Content-Length:
      description: The length of the response body in octets (8-bit bytes).
      schema:
        type: integer
        format: int32
        minimum: 0
      example: 12345

  responses:

    NoContent: #HTTP 204
      description: No content to return. The request was successful but there is no content to return.

    NotModified: #HTTP 304
      description: Not modified. The resource has not changed since the last request.

    Unauthorized: #HTTP 401
      description: Unauthorized. JWT is missing or invalid.

    Forbidden: #HTTP 403
      description: Forbidden. The user does not have permission to perform the action.

    Conflict: #HTTP 409
      description: Conflict. The request could not be completed due to a conflict with the current state of the resource.

    LengthRequired: #HTTP 411
      description: Length required. The request did not specify the length of its content, which is required by the requested resource.
  
    PreconditionFailed: #HTTP 412
      description: Precondition failed. The server does not meet one of the preconditions that the requester put on the request.

    ContentTooLarge: #HTTP 413
      description: Content too large. The request is larger than the server is willing or able to process.

    RequestHeaderFieldsTooLarge: #HTTP 431
      description: Header fields too large. The server is unwilling to process the request because its header fields are too large.

    BadRequest: #HTTP 400
      description: Bad request. The request was invalid or cannot be served.

    NotFound: #HTTP 404
      description: Not found. The requested resource could not be found.

    MethodNotAllowed: #HTTP 405
      description: Method not allowed. The request method is known but not supported by the target resource.

    RequestTimeout: #HTTP 408
      description: Request timeout. Idle time has passed without any data being sent or received.

    InternalServerError: #HTTP 500
      description: Internal server error. The server encountered an unexpected condition that prevented it from fulfilling the request.

    NotImplemented: #HTTP 501
      description: Not implemented. The server does not support the method or functionality required to fulfill the request.

    BadGateway: #HTTP 502
      description: Bad gateway. The server received an invalid response from an upstream server.

    ServiceUnavailable: #HTTP 503
      description: Service unavailable. The server is currently unable to handle the request due to a temporary overloading or maintenance of the server.

    GatewayTimeout: #HTTP 504
      description: Gateway timeout. The server did not receive a timely response from an upstream server it needed to access in order to complete the request.

    ImATeaPot: #HTTP 418
      description: I"m a teapot. The server is a teapot, not a coffee machine.

  securitySchemes:
    jwtAuth:
      description: JWT used for authorization. Send the token in the `Authorization` header with the format `Bearer {token}`.
      type: http
      scheme: bearer
      bearerFormat: JWT
